        <%ST(A)%>
			<div id="Content_ContentList" class="content-width"><a name="body" accesskey="B" href="#body"></a>
				<div class="pageContent">
					<div style="float:right;width:auto"><img border="0" src="images/Cprevious.gif" alt=""/><strong>上一篇:</strong> <a href="?id=24" accesskey=",">怎么实现让电脑在停电断电后，来电时能自动开机</a><br><img border="0" src="images/Cnext.gif" alt=""/><strong>下一篇:</strong> <a href="?id=26" accesskey=".">最简单的ASP生成静态文件代码(带静态生成模版)</a><br></div> 
					<img src="images/icons/3.gif" style="margin:0px 2px -4px 0px" alt=""/> <strong><a href="default.asp?cateID=4" title="查看所有【资源共享】的日志">资源共享</a></strong> <a href="feed.asp?cateID=4" target="_blank" title="订阅所有【资源共享】的日志" accesskey="O"><img border="0" src="images/rss.png" alt="订阅所有【资源共享】的日志" style="margin-bottom:-1px"/></a>
				</div>
				<div class="Content">
					<div class="Content-top"><div class="ContentLeft"></div><div class="ContentRight"></div>
					<h1 class="ContentTitle"><strong>最简单的ASP生成静态文件代码</strong></h1>
					<h2 class="ContentAuthor">作者:jinbenli 日期:2011-07-28 14:56:14</h2>
				</div>
			    <div class="Content-Info">
					<div class="InfoOther">字体大小: <a href="javascript:SetFont('12px')" accesskey="1">小</a> <a href="javascript:SetFont('14px')" accesskey="2">中</a> <a href="javascript:SetFont('16px')" accesskey="3">大</a></div>
					<div class="InfoAuthor"><img src="images/weather/hn2_sunny.gif" style="margin:0px 2px -6px 0px" alt=""/><img src="images/weather/hn2_t_sunny.gif" alt=""/> <img src="images/level3.gif" style="margin:0px 2px -1px 0px" alt=""/><$EditAndDel$></div>
				</div>
				<div id="logPanel" class="Content-body">
					以下代码是一段非常简单的ASP生成HTML静态页的实例，简单的说明了HTML静态页的生成。<br/><br/>事先声明：服务器必须支持FSO才能用以下方法生成HTML静态页。<br/><br/>输入一个标题和部分内容，然后点“生成HTML页”，就可以在同目录下生成一个叫“test.html”的静态页。<br/><br/>根据这个原理，可以生成很多其他格式的文件，如.txt文本文件等。<br/><br/>ASP相关代码：<br/>&lt;% <br/>If Request.Form(&#34;Content&#34;)&lt;&gt;&#34;&#34; Then <br/> Rem 可以自定义文件名 <br/> filename = &#34;test.html&#34; <br/> Rem 创建FSO对象 <br/> Set fso = Server.Cr&#101;ateObject(&#34;Scripting.FileSystemObject&#34;) <br/> Rem 将相对路径转换成绝对路径，然后生成html文件 <br/> Set htmlwrite= fso.Cr&#101;ateTextFile(Server.MapPath(&#34;&#34;&amp;filename&amp;&#34;&#34;)) <br/> Rem 将文本内容写入文件 <br/> htmlwrite.Write &#34;标题(title):&#34; &amp; Request.Form(&#34;Title&#34;) &amp; &#34;&lt;br&gt;&#34; <br/> htmlwrite.Write &#34;内容(Content):&#34; &amp; Request.Form(&#34;Content&#34;) <br/> htmlwrite.Close <br/> Rem 释放对象 <br/> Set htmlwrite= Nothing <br/> Set fso = Nothing <br/>End If <br/>%&gt; <br/>&lt;form name=&#34;form1&#34; method=&#34;post&#34; action=&#34;&#34;&gt; <br/> &lt;input name=&#34;Title&#34; id=&#34;Title&#34; size=30&gt; <br/> &lt;br&gt; <br/> &lt;br&gt; <br/> &lt;textarea name=&#34;Content&#34; cols=&#34;50&#34; rows=&#34;8&#34;&gt;&lt;/textarea&gt; <br/> &lt;br&gt; <br/> &lt;br&gt; <br/> &lt;input type=&#34;submit&#34; name=&#34;Submit&#34; value=&#34;生成HTML页&#34;&gt; <br/>&lt;/form&gt; <br/><br/><br/>　　根据以上代码，可以添加或灵活修改成自己想要的方式。<br/><br/><br/>　　一般静态页，还有个批量生成的概念，这里这个方法当然不适合批量生成。无论是否存在批量生成的概念，生成静态页避免重名都是要做的，下边说下尽量避免重名的方法：<br/><br/>ASP相关代码：<br/>Rem 生成文件名的函数 <br/>Function MakeFileName(fname) <br/> fname = fname <br/> fname = Replace(fname,&#34;-&#34;,&#34;&#34;) <br/> fname = Replace(fname,&#34; &#34;,&#34;&#34;)&nbsp;&nbsp;<br/> fname = Replace(fname,&#34;:&#34;,&#34;&#34;) <br/> fname = Replace(fname,&#34;PM&#34;,&#34;&#34;) <br/> fname = Replace(fname,&#34;AM&#34;,&#34;&#34;) <br/> fname = Replace(fname,&#34;上午&#34;,&#34;&#34;) <br/> fname = Replace(fname,&#34;下午&#34;,&#34;&#34;) <br/> MakeFileName = fname <br/>End Function <br/><br/><br/>　　此函数在使用时，将系统的Now()函数值传递过去，作为参数，将时间精确到秒，因为时间是一直不断变化，所以重复的几率很低。<br/><br/>　　当然，计算机的处理速度用秒来衡量似乎有点太大，所以，有时只是精确到秒，还是会出现重名的几率，此时，就要在这个以时间命名的文件名的基础上，再配合一个随机数。这样几乎就防止了文件名的重名问题。<br/><br/>　　一般较常见的是随机生成五位数：<br/><br/>ASP相关代码：<br/>Randomize <br/>RndNum = Int(89999*Rnd+10000) <br/><br/><br/>　　这样就可以了，注意：Randomize必须有，否则不能生成不重复的五位数。<br/><br/>　　经过以上两个方法获得的文件名的格式：系统当前时间+5位随机数＋.html<br/><br/>　　例如：200842118443056831.html，其中2008421184430是系统当前时间，而56831则是生成的随机数，后边的.html就是设置的文件的扩展名。要是换成.txt就变成了一个文本文件。<br/><br/>　　将开始的简单生成静态页文件的代码做如下修改，就变成了新的生成HTML静态页的方法。与之前不同的是，文件名不在需要人为的去写，而是随机生成的不重复的文件名。 <br/><br/>ASP相关代码：<br/>&lt;% <br/>Rem 生成文件名的函数&nbsp;&nbsp;<br/>Function MakeFileName(fname)&nbsp;&nbsp;<br/> fname = fname&nbsp;&nbsp;<br/> fname = Replace(fname,&#34;-&#34;,&#34;&#34;)&nbsp;&nbsp;<br/> fname = Replace(fname,&#34; &#34;,&#34;&#34;)&nbsp;&nbsp; <br/> fname = Replace(fname,&#34;:&#34;,&#34;&#34;)&nbsp;&nbsp;<br/> fname = Replace(fname,&#34;PM&#34;,&#34;&#34;)&nbsp;&nbsp;<br/> fname = Replace(fname,&#34;AM&#34;,&#34;&#34;)&nbsp;&nbsp;<br/> fname = Replace(fname,&#34;上午&#34;,&#34;&#34;)&nbsp;&nbsp;<br/> fname = Replace(fname,&#34;下午&#34;,&#34;&#34;)&nbsp;&nbsp;<br/> MakeFileName = fname&nbsp;&nbsp;<br/>End Function <br/>Randomize&nbsp;&nbsp;<br/>RndNum = Int(89999*Rnd+10000) <br/><br/>If Request.Form(&#34;Content&#34;)&lt;&gt;&#34;&#34; Then&nbsp;&nbsp;<br/> Rem 可以自定义文件名&nbsp;&nbsp;<br/> filename = MakeFileName(Now()) &amp; RndNum &amp; &#34;.html&#34; <br/> Rem 创建FSO对象&nbsp;&nbsp;<br/> Set fso = Server.Cr&#101;ateObject(&#34;Scripting.FileSystemObject&#34;)&nbsp;&nbsp;<br/> Rem 将相对路径转换成绝对路径，然后生成html文件&nbsp;&nbsp;<br/> Set htmlwrite= fso.Cr&#101;ateTextFile(Server.MapPath(&#34;&#34;&amp;filename&amp;&#34;&#34;))&nbsp;&nbsp;<br/> Rem 将文本内容写入文件&nbsp;&nbsp;<br/> htmlwrite.Write &#34;标题(title):&#34; &amp; Request.Form(&#34;Title&#34;) &amp; &#34;&lt;br&gt;&#34;&nbsp;&nbsp;<br/> htmlwrite.Write &#34;内容(Content):&#34; &amp; Request.Form(&#34;Content&#34;)&nbsp;&nbsp;<br/> htmlwrite.Close&nbsp;&nbsp;<br/> Rem 释放对象&nbsp;&nbsp;<br/> Set htmlwrite= Nothing&nbsp;&nbsp;<br/> Set fso = Nothing&nbsp;&nbsp;<br/>End If&nbsp;&nbsp;<br/>%&gt;&nbsp;&nbsp;<br/>&lt;form name=&#34;form1&#34; method=&#34;post&#34; action=&#34;&#34;&gt;&nbsp;&nbsp;<br/> &lt;input name=&#34;Title&#34; id=&#34;Title&#34; size=30&gt;&nbsp;&nbsp;<br/> &lt;br&gt;&nbsp;&nbsp;<br/> &lt;br&gt;&nbsp;&nbsp;<br/> &lt;textarea name=&#34;Content&#34; cols=&#34;50&#34; rows=&#34;8&#34;&gt;&lt;/textarea&gt;&nbsp;&nbsp;<br/> &lt;br&gt;&nbsp;&nbsp;<br/> &lt;br&gt;&nbsp;&nbsp;<br/> &lt;input type=&#34;submit&#34; name=&#34;Submit&#34; value=&#34;生成HTML页&#34;&gt;&nbsp;&nbsp;<br/>&lt;/form&gt; <br/><br/><strong>方法2：</strong><br/>------------------------------------------------------------------<br/>比如要生成一个正常的index.asp页面，并且用ASP代码调出数据库中的内容，我们建立一个makehtml.asp的页面，加入一个textarea域，假设为name=&#34;body&#34;，将index.asp在textarea里调出来，如：<br/>&lt;textarea name=&#34;body&#34;&gt;&lt;!--#include file=&#34;index.asp&#34;--&gt;&lt;/textarea&gt;，<br/>再将这个textarea包含在表单中.<br/><br/>makehtml.asp文件代码如下：<br/>&lt;form id=&#34;form1&#34; name=&#34;form1&#34; method=&#34;post&#34; action=&#34;&#34;&gt;<br/>&lt;textarea name=&#34;body&#34;&gt;&lt;!--#include file=&#34;index.asp&#34;--&gt;<br/>&lt;/textarea&gt;<br/>&nbsp;&nbsp;&lt;label&gt;<br/>&nbsp;&nbsp;&nbsp;&nbsp;&lt;input type=&#34;submit&#34; name=&#34;button&#34; id=&#34;button&#34; value=&#34;提交&#34; /&gt;<br/>&nbsp;&nbsp;&lt;/label&gt;<br/>&lt;/form&gt;<br/><br/>&lt;%<br/>filename=&#34;index.html&#34;<br/>if request(&#34;body&#34;)&lt;&gt;&#34;&#34; then<br/>set fso = Server.Cr&#101;ateObject(&#34;Scripting.FileSystemObject&#34;)<br/>set fout= fso.Cr&#101;ateTextFile(server.mappath(&#34;&#34;&amp;filename&amp;&#34;&#34;))<br/>fout.write request.form(&#34;body&#34;)<br/>fout.close<br/>set fout=nothing<br/>set fso=nothing<br/>end if<br/>%&gt;<br/><br/>这样index.html文件就生成了<br/>
					<br/><br/>
				</div>
				<div class="Content-body">
					
					<img src="images/From.gif" style="margin:0px 2px -4px 0px" alt=""/><strong>文章来自:</strong> <a href="http://jinbenli.com/" target="_blank">本站原创</a><br/>
					<img src="images/icon_trackback.gif" style="margin:4px 2px -4px 0px" alt=""/><strong>引用通告:</strong> <a href="trackback.asp?tbID=25&amp;action=view" target="_blank">查看所有引用</a> | <a href="javascript:;" title="获得引用文章的链接" onclick="getTrackbackURL(25)">我要引用此文章</a><br/>
					<img src="images/tag.gif" style="margin:4px 2px -4px 0px" alt=""/><strong>Tags:</strong> <a href="default.asp?tag=asp%E4%BB%A3%E7%A0%81">asp代码</a><a href="http://technorati.com/tag/asp代码" rel="tag" style="display:none">asp代码</a> <br/>
					<img src="images/notify.gif" style="margin:4px 2px -4px 0px" alt=""/><strong>相关日志:</strong>
                    <div class="Content-body" id="related_tag" style="margin-left:25px"></div>
                    <script language="javascript" type="text/javascript">Related(25, 1, "related_tag");</script>
				</div>
				<div class="Content-bottom"><div class="ContentBLeft"></div><div class="ContentBRight"></div>评论: 0 | <a href="trackback.asp?tbID=25&amp;action=view" target="_blank">引用: 0</a> | 查看次数: <$log_ViewNums$></div>
			</div>
		</div>
